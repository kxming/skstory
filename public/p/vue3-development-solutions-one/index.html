<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="Vue3 Development Solutions">
<title>Vue3 Development Solutions One</title>

<link rel='canonical' href='http://localhost:1313/p/vue3-development-solutions-one/'>

<link rel="stylesheet" href="/scss/style.min.d8118f156935b64eca93aca758476adca858d2c47354971654d9bd2933a0e45f.css"><meta property='og:title' content="Vue3 Development Solutions One">
<meta property='og:description' content="Vue3 Development Solutions">
<meta property='og:url' content='http://localhost:1313/p/vue3-development-solutions-one/'>
<meta property='og:site_name' content='SK Story'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Javascript' /><meta property='article:tag' content='Vue' /><meta property='article:published_time' content='2024-02-12T16:22:33&#43;08:00'/><meta property='article:modified_time' content='2024-02-12T16:22:33&#43;08:00'/><meta property='og:image' content='https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYdGMu4svwz6UJ6Izma43g.png' />
<meta name="twitter:site" content="@https://twitter.com/ShawnKxming">
    <meta name="twitter:creator" content="@https://twitter.com/ShawnKxming"><meta name="twitter:title" content="Vue3 Development Solutions One">
<meta name="twitter:description" content="Vue3 Development Solutions"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYdGMu4svwz6UJ6Izma43g.png' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu61f49258472ba116407e56a959fa113d_189154_300x0_resize_q75_box.jpeg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üç•</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">SK Story</a></h1>
            <h2 class="site-description">Shawn King&#39;s Stories Website</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='mailto:kxming0229@gmail.com'
                        target="_blank"
                        title="Email"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" /><path d="M3 7l9 6l9 -6" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://www.facebook.com/p/King-Shawn-100092679065959/'
                        target="_blank"
                        title="Facebook"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-facebook"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/ShawnKxming'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-x"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16h4.267l-11.733 -16z" /><path d="M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://t.me/shawnkxming'
                        target="_blank"
                        title="Telegram"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-telegram"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://medium.com/@kxming'
                        target="_blank"
                        title="Medium"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-medium"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z" /><path d="M8 9h1l3 3l3 -3h1" /><path d="M8 15l2 0" /><path d="M14 15l2 0" /><path d="M9 9l0 6" /><path d="M15 9l0 6" /></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#customized-high-availability-front-end-style-processing-solution">Customized, high-availability front-end style processing solution</a></li>
    <li><a href="#vueuse-a-practical-toolset-for-vues-compositional-api">VueUse A practical toolset for Vue‚Äôs compositional API</a></li>
    <li><a href="#why-is-vite-faster-thanwebpack">Why is vite faster than¬†webpack?</a></li>
    <li><a href="#vite-development-configuration">vite development configuration</a></li>
    <li><a href="#automatic-registration-of-common-components">Automatic registration of common components</a></li>
    <li><a href="#use-svg-as-icon">Use svg as icon</a></li>
    <li><a href="#persistent-state-data-vuex-persistedstate">Persistent state data vuex-persistedstate</a></li>
    <li><a href="#theme-switching-implementation">Theme switching implementation</a></li>
    <li><a href="#implement-waterfall-flow-layout">Implement waterfall flow layout</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/vue3-development-solutions-one/">
                
                    <img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYdGMu4svwz6UJ6Izma43g.png" loading="lazy" alt="Featured image of post Vue3 Development Solutions One" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/javascript/" style="background-color: #D1D419; color: #fff;">
                Javascript
            </a>
        
            <a href="/categories/vue/" style="background-color: #28A243; color: #fff;">
                Vue
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/vue3-development-solutions-one/">Vue3 Development Solutions One</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Vue3 Development Solutions
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 12, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    18 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="customized-high-availability-front-end-style-processing-solution">Customized, high-availability front-end style processing solution</h2>
<p>Pain points in CSS processing under enterprise-level projectsÔºö</p>
<ul>
<li>
<p>Unified variables are difficult to maintain</p>
</li>
<li>
<p>Lots of className overhead</p>
</li>
<li>
<p>The writing burden caused by the separation of HTML and CSS</p>
</li>
<li>
<p>Responsive, theme switching is complex to implement</p>
</li>
</ul>
<p>For more pain points, see <a class="link" href="https://adamwathan.me/css-utility-classes-and-separation-of-concerns/"  target="_blank" rel="noopener"
    >CSS Utility Classes and ‚ÄúSeparation of Concerns‚Äù</a></p>
<p>In response to the above problems, we can solve it through <a class="link" href="https://tailwindcss.com/"  target="_blank" rel="noopener"
    >tailwindcss</a>. Let‚Äôs look at its specific usage below.</p>
<p><strong>Installation</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">yarn add tailwindcss postcss autoprefixer -D
</span></span></code></pre></td></tr></table>
</div>
</div><p>Initializes the <code>tailwindcss.config.js</code> configuration file and also creates the <code>postcss.config.js</code> file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// -p This represents creating a basic configuration file.
</span></span><span class="line"><span class="cl">npx tailwindcss init -p
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">//</span> <span class="n">tailwindcss</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">js</span>
</span></span><span class="line"><span class="cl"><span class="o">/**</span> <span class="err">@</span><span class="n">type</span> <span class="p">{</span><span class="n">import</span><span class="p">(</span><span class="s1">&#39;tailwindcss&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">Config</span><span class="p">}</span> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">The</span> <span class="n">scope</span> <span class="n">of</span> <span class="n">files</span> <span class="n">applied</span> <span class="n">by</span> <span class="n">Tailwind</span> <span class="n">CSS</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">content</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;./index.html&#39;</span><span class="p">,</span> <span class="s1">&#39;./src/**/*.{vue,js}&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="n">theme</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">extend</span><span class="p">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="n">plugins</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Add instructions to load Tailwind to your CSS file</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@tailwind base;
</span></span><span class="line"><span class="cl">@tailwind components;
</span></span><span class="line"><span class="cl">@tailwind utilities;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Use built-in class names on elements</p>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PNyxfP_-GYnFZaNqLon0AQ.jpeg"
	
	
	
	loading="lazy"
	
	
></p>
<p>Tailwindcss is officially introduced to quickly build modern websites without leaving HTML. Specifically, tailwind provides many class names, all of which define specific css. You can quickly build a website by directly adding the corresponding class name when writing HTML.</p>
<p><strong>The design concept of tailwindcss</strong></p>
<p>First, let‚Äôs take a look at the css granular design form</p>
<ul>
<li>Inline styles. The highest degree of freedom and the strongest customization. But it is inconvenient to reuse styles.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;div style=&#34;color: red; font-size: 20px&#34;&gt;zh-llm&lt;/div&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Atomized css, each class name represents a type of css style. The degree of freedom is still very strong, the customization is also very high, and the styles can be reused. But a lot of meaningless class names will be written. Among them, tailwindcss is this design.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;div class=&#34;text-sky-400&#34;&gt;zh-llm&lt;/div&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>In the traditional form, one or several semantic classes are used to describe a CSS attribute. It is encapsulated, has strong semantics, and has average freedom and customizability (most class names are written with the entire set of CSS attributes of the corresponding element). However, there are a large number of semantic classes, which require switching back and forth between HTML and CSS when writing.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;div class=&#34;container clear&#34;&gt;&lt;/div&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>In component form, the structure and style are directly defined in the current component. It has strong encapsulation and strong semantics. However, the degree of freedom and customizability are relatively poor. And the style is fixed, which is more suitable for background projects. Such as element-plus and so on.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> &lt;my-component /&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Comparing the four design methods, we can see that atomized CSS has a degree of freedom, is customizable, and has good reusability. It only has the disadvantage of writing a large number of meaningless class names. Compared with its advantages, the disadvantages can be ignored. But for those who maintain the project, if they don‚Äôt understand the class names defined in tailwindcss, it may be a very headache.</li>
</ul>
<p>For high personalization, high interactivity, and highly customized front-end project style solutions, the atomized CSS form is more suitable.</p>
<p>When developing with vscode, we can install a Tailwind CSS IntelliSense plug-in to prompt for class names to help us develop better.</p>
<h2 id="vueuse-a-practical-toolset-for-vues-compositional-api">VueUse A practical toolset for Vue‚Äôs compositional API</h2>
<p><a class="link" href="https://www.vueusejs.com/"  target="_blank" rel="noopener"
    >VueUse</a>, a set of practical tools based on Vue‚Äôs composite API. It encapsulates many common and reusable functions. It supports Vue2, Vue3, and Nuxt. It can be understood as the lodash of the Vue world. It can be used out of the box and is very convenient.</p>
<p>The core package has 140+ combined functions, and also provides 10 extension plug-ins, totaling about 290+ functions.</p>
<p><strong>Function</strong></p>
<ul>
<li>
<p>State: Manage user status (such as: global, local storage, session storage)</p>
</li>
<li>
<p>Elements: Element processing related (such as: element dragging, element visibility, window size)</p>
</li>
<li>
<p>Browser: Browser related (such as: updating page title, media query, clipboard)</p>
</li>
<li>
<p>Sensors: monitor different DOM events, input events, network events, etc.</p>
</li>
<li>
<p>Network: Network request related</p>
</li>
<li>
<p>Animation: Transitions, timeouts and timing functions</p>
</li>
<li>
<p>Component: Provides abbreviations for different component methods</p>
</li>
<li>
<p>Watch: Provides some monitors (such as: monitoring changes after promises, anti-shake monitoring, throttling monitoring)</p>
</li>
<li>
<p>Reactivity: Responsive function related</p>
</li>
<li>
<p>Array: Responsive array processing</p>
</li>
<li>
<p>Time: Provides response time formatting function</p>
</li>
<li>
<p>Utilities: general functions, such as throttling, anti-shake, etc.</p>
</li>
<li>
<p>Plugin: Electron„ÄÅFirebase„ÄÅHead„ÄÅIntegrations„ÄÅMath„ÄÅMotion„ÄÅRouter„ÄÅRxJS„ÄÅSchemaOrg„ÄÅSound</p>
</li>
</ul>
<p>The core functions are all in the packages/core folder.</p>
<p><strong>Installation</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  npm i @vueuse/core
</span></span><span class="line"><span class="cl">  // or
</span></span><span class="line"><span class="cl">  yarn add @vueuse/core
</span></span><span class="line"><span class="cl">  // or
</span></span><span class="line"><span class="cl">  pnpm add @vueuse/core 
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Use</strong></p>
<ul>
<li>
<p>all it directly as a function: for example, <code>const { toggle } = useFullScreen()</code>, which is also our most commonly used method.</p>
</li>
<li>
<p>Used as a component: Some functions are provided, such as <code>&lt;UseFullscreen&gt;&lt;UseFullscreen&gt;</code> .</p>
</li>
</ul>
<p>When called directly as a function, you can receive responsive parameters. Most functions will return a refs object, and you can use object destructuring to obtain the required content. Functions usually start with use.</p>
<p>For component usage, in addition to installing the <code>@vueuse/core</code> core package, you also need to install <code>@vueuse/components</code>, that is</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pnpm add @vueuse/core  @vueuse/components
</span></span></code></pre></td></tr></table>
</div>
</div><p>VueUse encapsulates many practical functions, such as: clipboard (useClipboard), anti-shake (useDebounceFn), setting the title of the web page (useTitle), and listening for events (useEventListener). Page uninstallation can automatically help us delete event monitoring without us having to delete it manually. etc. Before encapsulating hooks yourself, you can go to the official website to see if they have been encapsulated to improve development efficiency.</p>
<p>VueUse also has good interactive documentation and function demonstrations. It is written in TS. The core source code of each function is relatively small and easy to read. In addition to using its encapsulated functions, we can also learn function encapsulation skills by looking at its source code. Learn good coding habits.</p>
<h2 id="why-is-vite-faster-thanwebpack">Why is vite faster than¬†webpack?</h2>
<p>When building during webpack development, your entire application will be crawled and built by default before it can provide services. This will cause any error in your project (even if the current error is not a module referenced on the homepage), it will still affect it. to your entire project build. So the bigger your project is, the longer the build time will be and the slower the project startup will be.</p>
<p>Vite will not build your entire project at the beginning, but will divide the modules in the reference into two parts: dependency and source code (project code). For the source code part, it will split the code modules according to routing, and will only go Build what you have to build from the get-go.</p>
<p>At the same time, Vite provides the source code to the browser in the form of native ESM, allowing the browser to take over part of the packaging work.</p>
<h2 id="vite-development-configuration">vite development configuration</h2>
<p><strong>Configure path alias</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">//</span> <span class="n">vite</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">js</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span> <span class="n">defineConfig</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;vite&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">vue</span> <span class="n">from</span> <span class="s1">&#39;@vitejs/plugin-vue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span><span class="n">join</span><span class="p">}</span> <span class="n">from</span> <span class="s2">&#34;path&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">vitejs</span><span class="o">.</span><span class="n">dev</span><span class="o">/</span><span class="n">config</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">default</span> <span class="n">defineConfig</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="n">plugins</span><span class="p">:</span> <span class="p">[</span><span class="n">vue</span><span class="p">()],</span>
</span></span><span class="line"><span class="cl">  <span class="n">resolve</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">alias</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;@&#34;</span><span class="p">:</span> <span class="n">join</span><span class="p">(</span><span class="n">__dirname</span><span class="p">,</span> <span class="s2">&#34;/src&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Development environment solves cross-domain issues</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span> <span class="n">defineConfig</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;vite&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">vue</span> <span class="n">from</span> <span class="s1">&#39;@vitejs/plugin-vue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span><span class="n">join</span><span class="p">}</span> <span class="n">from</span> <span class="s2">&#34;path&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">vitejs</span><span class="o">.</span><span class="n">dev</span><span class="o">/</span><span class="n">config</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">default</span> <span class="n">defineConfig</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="n">plugins</span><span class="p">:</span> <span class="p">[</span><span class="n">vue</span><span class="p">()],</span>
</span></span><span class="line"><span class="cl">  <span class="n">resolve</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">alias</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;@&#34;</span><span class="p">:</span> <span class="n">join</span><span class="p">(</span><span class="n">__dirname</span><span class="p">,</span> <span class="s2">&#34;/src&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="n">server</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">proxy</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="o">//</span> <span class="n">Proxy</span> <span class="n">all</span> <span class="o">/</span><span class="n">api</span> <span class="n">requests</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;/api&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">target</span><span class="p">:</span> <span class="s2">&#34;target origin&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="o">//</span> <span class="n">Change</span> <span class="n">the</span> <span class="n">origin</span> <span class="n">of</span> <span class="n">the</span> <span class="n">request</span> <span class="n">to</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">target</span>
</span></span><span class="line"><span class="cl">        <span class="n">changeOrigin</span><span class="p">:</span> <span class="bp">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Configure environment variables</strong></p>
<p>Enterprise-level projects will distinguish many environments for us to test and trial. We cannot let our test data contaminate the online data.
Therefore, Vite also provides a way to configure our environment files, allowing us to easily select the corresponding interface address and so on through some environments.</p>
<p>The format of <code>.env.[mode]</code> can load different content in different modules.</p>
<p>Environment loading priority:</p>
<ul>
<li>
<p>A file that specifies a pattern (e.g. <code>.env.production</code> ) will take precedence over a generic form (e.g. <code>.env</code> ).</p>
</li>
<li>
<p>In addition, environment variables that already exist when Vite is executed have the highest priority and will not be overwritten by the <code>.env</code> class file. For example when running <code>VITE_SOME_KEY=123</code> vite build .</p>
</li>
<li>
<p><code>.env</code> The class file will be loaded when Vite starts, and changes will take effect after restarting the server.</p>
</li>
</ul>
<p>We can obtain loaded environment variables starting with <code>VITE_</code> through <code>import.meta.env.*</code> in the code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// .env.development
</span></span><span class="line"><span class="cl">VITE_BASE_API = &#34;/api&#34;
</span></span><span class="line"><span class="cl">// package.json
</span></span><span class="line"><span class="cl">&#34;scripts&#34;: {
</span></span><span class="line"><span class="cl">    &#34;dev&#34;: &#34;VITE_BASE_API=/oop vite&#34;,
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>After executing yarn dev , we can find that import.meta.env.VITE_BASE_API is the parameter specified in the command line.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DEyxvyBRfdg2uXD9dCXIkg.jpeg"
	
	
	
	loading="lazy"
	
	
></p>
<h2 id="automatic-registration-of-common-components">Automatic registration of common components</h2>
<p><a class="link" href="https://vitejs.dev/guide/features.html#glob-import"  target="_blank" rel="noopener"
    >Vite‚Äôs Glob import</a> function: This function can help us import multiple modules in the file system</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">modules</span> <span class="o">=</span> <span class="n">import</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;./dir/*.js&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">translate</span><span class="err">Ôºö</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">modules</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;./dir/foo.js&#39;</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="n">import</span><span class="p">(</span><span class="s1">&#39;./dir/foo.js&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;./dir/bar.js&#39;</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="n">import</span><span class="p">(</span><span class="s1">&#39;./dir/bar.js&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Then introduce it through the way of registering asynchronous components provided by vue. Vue‚Äôs <code>defineAsyncComponent</code> method: This method can create an asynchronous component that is loaded on demand. Based on the above two methods, the component can be automatically registered.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">//</span> <span class="n">import</span> <span class="n">SvgIcon</span> <span class="n">from</span> <span class="s1">&#39;./svg-icon/index.vue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">import</span> <span class="n">HmPopup</span> <span class="n">from</span> <span class="s1">&#39;./popup/index.vue&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span> <span class="n">defineAsyncComponent</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;vue&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="k">const</span> <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">SvgIcon</span><span class="p">,</span> <span class="n">HmPopup</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">install</span><span class="p">(</span><span class="n">app</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">components</span><span class="o">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">element</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span>   <span class="n">app</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">Get</span> <span class="n">all</span> <span class="n">index</span><span class="o">.</span><span class="n">vue</span> <span class="n">under</span> <span class="n">the</span> <span class="n">current</span> <span class="n">path</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="n">components</span> <span class="o">=</span> <span class="n">import</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;./*/index.vue&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">Traverse</span> <span class="n">the</span> <span class="n">obtained</span> <span class="n">component</span> <span class="n">module</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">let</span> <span class="p">[</span><span class="n">key</span><span class="p">,</span> <span class="n">component</span><span class="p">]</span> <span class="n">of</span> <span class="ne">Object</span><span class="o">.</span><span class="n">entries</span><span class="p">(</span><span class="n">components</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">const</span> <span class="n">componentName</span> <span class="o">=</span> <span class="s1">&#39;hm-&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="o">//</span> <span class="n">asynchronously</span> <span class="n">import</span> <span class="n">components</span> <span class="n">under</span> <span class="n">specified</span> <span class="n">path</span> <span class="n">using</span> <span class="n">defineAsyncComponent</span>
</span></span><span class="line"><span class="cl">      <span class="n">app</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">componentName</span><span class="p">,</span> <span class="n">defineAsyncComponent</span><span class="p">(</span><span class="n">component</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In fact, if the components all provide the name attribute, we can directly manually introduce each component module and then achieve semi-automatic registration.</p>
<p>The advantage of providing a name for a component is that it is convenient to find each component when debugging in vue-devtools.</p>
<p>In the vue official website, in versions 3.2.34 or above, the single-file component using <code>&lt;script setup&gt;</code> will automatically generate the corresponding name option based on the file name, even when used with <code>&lt;KeepAlive&gt;</code> There is no need to declare manually when using it. But for us developers whose file names are all index.vue, there is no way.</p>
<h2 id="use-svg-as-icon">Use svg as icon</h2>
<p>First we need to encapsulate a general svg component to use svg icons.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">template</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">svg</span> <span class="n">aria</span><span class="o">-</span><span class="n">hidden</span><span class="o">=</span><span class="s2">&#34;true&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">use</span> <span class="p">:</span><span class="n">xlink</span><span class="p">:</span><span class="n">href</span><span class="o">=</span><span class="s2">&#34;symbolId&#34;</span> <span class="p">:</span><span class="n">fill</span><span class="o">=</span><span class="s2">&#34;color&#34;</span> <span class="p">:</span><span class="n">fillClass</span><span class="o">=</span><span class="s2">&#34;fillClass&#34;</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">svg</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">template</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">script</span> <span class="n">setup</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span> <span class="n">computed</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;vue&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">props</span> <span class="o">=</span> <span class="n">defineProps</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="n">name</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span><span class="p">:</span> <span class="ne">String</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">required</span><span class="p">:</span> <span class="bp">true</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="n">color</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span><span class="p">:</span> <span class="ne">String</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="n">fillClass</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span><span class="p">:</span> <span class="ne">String</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">Generate</span> <span class="n">a</span> <span class="n">unique</span> <span class="n">icon</span> <span class="n">id</span> <span class="c1">#icon-xxx</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">symbolId</span> <span class="o">=</span> <span class="n">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="err">`</span><span class="c1">#icon-${props.name}`)</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Then register the svg universal component globally. Here we use the plug-in method.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">SvgIcon</span> <span class="n">from</span> <span class="s2">&#34;./svg-icon/index.vue&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">install</span><span class="p">(</span><span class="n">app</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="s2">&#34;SvgIcon&#34;</span><span class="p">,</span> <span class="n">SvgIcon</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>After registering directly through use in main.js, it can be used.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;svg-icon name=&#34;back&#34;&gt;&lt;/svg-icon&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>However, the path of the svg icon cannot be known in the project. We need to use the <code>vite-plugin-svg-icons</code> plug-in to specify the search path.</p>
<p>Configure svg related content in <code>vite.config.js</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span> <span class="n">defineConfig</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;vite&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">vue</span> <span class="n">from</span> <span class="s1">&#39;@vitejs/plugin-vue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span><span class="n">join</span><span class="p">}</span> <span class="n">from</span> <span class="s2">&#34;path&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span><span class="n">createSvgIconsPlugin</span><span class="p">}</span> <span class="n">from</span> <span class="s2">&#34;vite-plugin-svg-icons&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">vitejs</span><span class="o">.</span><span class="n">dev</span><span class="o">/</span><span class="n">config</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">default</span> <span class="n">defineConfig</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="n">plugins</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="n">vue</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="n">createSvgIconsPlugin</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="o">//</span> <span class="n">Specify</span> <span class="n">the</span> <span class="n">icon</span> <span class="n">folders</span> <span class="n">that</span> <span class="n">need</span> <span class="n">to</span> <span class="n">be</span> <span class="n">cached</span>
</span></span><span class="line"><span class="cl">      <span class="n">iconDirs</span><span class="p">:</span> <span class="p">[</span><span class="n">join</span><span class="p">(</span><span class="n">__dirname</span><span class="p">,</span> <span class="s2">&#34;/src/assets/icons&#34;</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">      <span class="o">//</span> <span class="n">Specify</span> <span class="n">symbolId</span> <span class="n">format</span><span class="p">,</span> <span class="n">which</span> <span class="n">is</span> <span class="n">the</span> <span class="n">href</span> <span class="n">used</span> <span class="n">by</span> <span class="n">svg</span><span class="o">.</span><span class="n">use</span>
</span></span><span class="line"><span class="cl">      <span class="n">symbolId</span><span class="p">:</span> <span class="s2">&#34;icon-[name]&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Import and register svg-icons in main.js, it will register all svg images in the specified folder on the homepage.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// register svg-icons
</span></span><span class="line"><span class="cl">import &#34;virtual:svg-icons-register&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="persistent-state-data-vuex-persistedstate">Persistent state data vuex-persistedstate</h2>
<p><a class="link" href="https://github.com/robinvdvleuten/vuex-persistedstate"  target="_blank" rel="noopener"
    >vuex-persistedstate</a>, as a plug-in of vuex, can persist the data in the store to prevent data loss due to page refresh and other operations. (When running again, the cached data will be used as the initial value of the corresponding state attribute)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span> <span class="n">createStore</span> <span class="p">}</span> <span class="n">from</span> <span class="s2">&#34;vuex&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">createPersistedState</span> <span class="n">from</span> <span class="s2">&#34;vuex-persistedstate&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">store</span> <span class="o">=</span> <span class="n">createStore</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">  <span class="n">plugins</span><span class="p">:</span> <span class="p">[</span><span class="n">createPersistedState</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="n">key</span> <span class="p">:</span> <span class="s1">&#39;categoryList&#39;</span><span class="p">,</span> <span class="o">//</span> <span class="n">The</span> <span class="n">key</span> <span class="k">for</span> <span class="n">cache</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">paths</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">],</span> <span class="o">//</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">any</span> <span class="n">paths</span> <span class="n">to</span> <span class="n">partially</span> <span class="n">persist</span> <span class="n">the</span> <span class="n">state</span><span class="o">.</span> <span class="n">If</span> <span class="n">no</span> <span class="n">paths</span> <span class="n">are</span> <span class="n">given</span><span class="p">,</span> <span class="n">the</span> <span class="n">complete</span> <span class="n">state</span> <span class="n">is</span> <span class="n">persisted</span><span class="o">.</span> <span class="n">If</span> <span class="n">an</span> <span class="n">empty</span> <span class="n">array</span> <span class="n">is</span> <span class="n">given</span><span class="p">,</span> <span class="n">no</span> <span class="n">state</span> <span class="n">will</span> <span class="n">be</span> <span class="n">persisted</span><span class="o">.</span> <span class="n">The</span> <span class="n">path</span> <span class="n">must</span> <span class="n">be</span> <span class="n">specified</span> <span class="n">using</span> <span class="n">dot</span> <span class="n">notation</span><span class="o">.</span> <span class="n">If</span> <span class="n">using</span> <span class="n">modules</span><span class="p">,</span> <span class="n">include</span> <span class="n">the</span> <span class="n">module</span> <span class="n">name</span><span class="o">.</span> <span class="n">Such</span> <span class="n">as</span><span class="p">:</span> <span class="s2">&#34;auth.user&#34;</span><span class="o">.</span> <span class="n">Default</span> <span class="n">is</span> <span class="n">undefined</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="p">})],</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="theme-switching-implementation">Theme switching implementation</h2>
<p>Implementation idea: (This solution is based on the tailwindcss plug-in)</p>
<p>The <code>tailwind.config.js</code> configuration file needs to be added</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">darkMode: &#39;class&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Store current theme type in vuex</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">//</span> <span class="n">current</span> <span class="n">theme</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span> <span class="n">THEME_LIGHT</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;@/constants&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">namespaced</span><span class="p">:</span> <span class="bp">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">state</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="n">themeType</span><span class="p">:</span> <span class="n">THEME_LIGHT</span>
</span></span><span class="line"><span class="cl">  <span class="p">}),</span>
</span></span><span class="line"><span class="cl">  <span class="n">mutations</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">setThemeType</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">theme</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">state</span><span class="o">.</span><span class="n">themeType</span> <span class="o">=</span> <span class="n">theme</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Modify the theme type in vuex when switching themes</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">handleHeaderTheme</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">store</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="s1">&#39;theme/setThemeType&#39;</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Monitor changes in theme types: theme-light, theme-dark, theme-system, and dynamically set the class attribute value for the html tag. He just adds the css prefix to the corresponding theme to the html element when switching. To achieve the effect of switching themes</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;html lang=&#34;en&#34; class=&#34;dark&#34;&gt;
</span></span><span class="line"><span class="cl">    &lt;!-- To add a dark mode CSS style, simply prepend it with the &#34;dark&#34; prefix. --&gt;
</span></span><span class="line"><span class="cl">    &lt;div class=&#34;bg-zinc-300 dark:bg-zinc-900&#34; &gt;&lt;/div&gt;
</span></span><span class="line"><span class="cl">&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>After the value of the class attribute of html changes, it will match the class of the corresponding theme, thereby displaying the color of the corresponding theme.</p>
<p>Set two sets of class names for labels: one for white and one for dark.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;div class=&#34;bg-zinc-300 dark:bg-zinc-900&#34; &gt;&lt;/div&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>To follow the theme changes of the system, you need to use <code>Window.matchMedia()</code>. This method receives a mediaQueryString (a string parsed by the media query). We can pass the prefers-color-scheme to this string, that is, <code>window.matchMedia('(prefers-color-scheme: dark)')</code> The method returns a <code>MediaQueryList</code> object.</p>
<ul>
<li>
<p>This object has a <code>change</code> event that can listen for system theme changes.</p>
</li>
<li>
<p>The event object <code>matches</code> attribute can determine the theme. (true: dark theme, false: light theme).</p>
</li>
</ul>
<p>Theme modification tool function</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span> <span class="n">watch</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;vue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">store</span> <span class="n">from</span> <span class="s1">&#39;../store&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span> <span class="n">THEME_DARK</span><span class="p">,</span> <span class="n">THEME_LIGHT</span><span class="p">,</span> <span class="n">THEME_SYSTEM</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;../constants&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Listen</span> <span class="k">for</span> <span class="n">system</span> <span class="n">theme</span> <span class="n">changes</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="n">let</span> <span class="n">matchMedia</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">changeSystemTheme</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Only</span> <span class="n">need</span> <span class="n">to</span> <span class="n">be</span> <span class="n">initialized</span> <span class="n">once</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">matchMedia</span><span class="p">)</span> <span class="k">return</span>
</span></span><span class="line"><span class="cl">  <span class="n">matchMedia</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">matchMedia</span><span class="p">(</span><span class="s1">&#39;(prefers-color-scheme: dark)&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">This</span> <span class="n">also</span> <span class="n">listens</span> <span class="k">for</span> <span class="n">theme</span> <span class="n">switching</span><span class="p">,</span> <span class="ow">and</span> <span class="n">then</span> <span class="n">calls</span> <span class="n">to</span> <span class="n">modify</span> <span class="n">the</span> <span class="n">HTML</span> <span class="k">class</span>
</span></span><span class="line"><span class="cl">  <span class="n">matchMedia</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">changeTheme</span><span class="p">(</span><span class="n">THEME_SYSTEM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="ne">Theme</span> <span class="n">matching</span> <span class="n">function</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="err">@</span><span class="n">param</span> <span class="n">val</span> <span class="p">{</span><span class="o">*</span><span class="p">}</span> <span class="ne">Theme</span> <span class="n">tag</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">changeTheme</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">let</span> <span class="n">htmlClass</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">===</span> <span class="n">THEME_LIGHT</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="ne">Light</span> <span class="n">theme</span>
</span></span><span class="line"><span class="cl">    <span class="n">htmlClass</span> <span class="o">=</span> <span class="n">THEME_LIGHT</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">===</span> <span class="n">THEME_DARK</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">Dark</span> <span class="n">theme</span>
</span></span><span class="line"><span class="cl">    <span class="n">htmlClass</span> <span class="o">=</span> <span class="n">THEME_DARK</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">Follow</span> <span class="n">the</span> <span class="n">system</span>
</span></span><span class="line"><span class="cl">    <span class="n">changeSystemTheme</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">True</span> <span class="n">is</span> <span class="n">dark</span> <span class="n">mode</span><span class="p">,</span> <span class="bp">false</span> <span class="n">is</span> <span class="n">light</span> <span class="n">theme</span>
</span></span><span class="line"><span class="cl">    <span class="n">htmlClass</span> <span class="o">=</span> <span class="n">matchMedia</span><span class="o">.</span><span class="n">matches</span> <span class="err">?</span> <span class="n">THEME_DARK</span> <span class="p">:</span> <span class="n">THEME_LIGHT</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">document</span><span class="o">.</span><span class="n">querySelector</span><span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">className</span> <span class="o">=</span> <span class="n">htmlClass</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Initialize</span> <span class="n">the</span> <span class="n">theme</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">default</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Listen</span> <span class="k">for</span> <span class="n">theme</span> <span class="n">switching</span> <span class="ow">and</span> <span class="n">modify</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">HTML</span> <span class="k">class</span>
</span></span><span class="line"><span class="cl">  <span class="n">watch</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="n">store</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">themeType</span><span class="p">,</span> <span class="n">changeTheme</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">immediate</span><span class="p">:</span> <span class="bp">true</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="implement-waterfall-flow-layout">Implement waterfall flow layout</h2>
<p>The construction of the entire waterfall flow component generally needs to be divided into several parts</p>
<ol>
<li>Pass key data through props</li>
</ol>
<ul>
<li>
<p>data: data source</p>
</li>
<li>
<p>nodeKey: unique identifier</p>
</li>
<li>
<p>column: number of columns rendered</p>
</li>
<li>
<p>columnSpacing: column spacing</p>
</li>
<li>
<p>rowSpacing: row spacing</p>
</li>
<li>
<p>picturePreReading: Whether picture pre-rendering is required</p>
</li>
</ul>
<ol start="2">
<li>
<p>Waterfall rendering mechanism: layout is completed through absolute and relative. The layout logic is: each item should be arranged horizontally, and the items in the second row are sequentially connected to the current shortest column.</p>
</li>
<li>
<p>Pass the key data involved in each item to the item view through the scope slot.</p>
</li>
</ol>
<p><strong>Calculate the width of each column</strong></p>
<p>The general calculation method is to get the container width (excluding margin, padding, border),</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">useContainerWidth</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">{</span> <span class="n">paddingLeft</span><span class="p">,</span> <span class="n">paddingRight</span> <span class="p">}</span> <span class="o">=</span> <span class="n">getComputedStyle</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">containerRef</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">null</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="ne">Container</span> <span class="n">left</span> <span class="n">margin</span>
</span></span><span class="line"><span class="cl">  <span class="n">containerLeft</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">parseFloat</span><span class="p">(</span><span class="n">paddingLeft</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="ne">Container</span> <span class="n">width</span>
</span></span><span class="line"><span class="cl">  <span class="n">containerWidth</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="n">containerRef</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">offsetWidth</span> <span class="o">-</span>
</span></span><span class="line"><span class="cl">    <span class="n">parseFloat</span><span class="p">(</span><span class="n">paddingLeft</span><span class="p">)</span> <span class="o">-</span>
</span></span><span class="line"><span class="cl">    <span class="n">parseFloat</span><span class="p">(</span><span class="n">paddingRight</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>And get the total spacing of each item element in the container.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">//</span> <span class="n">Total</span> <span class="n">column</span> <span class="n">spacing</span> <span class="n">size</span> <span class="p">(</span><span class="n">column</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">columnSpacing</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">columnSpacingTotal</span> <span class="o">=</span> <span class="n">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">column</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">props</span><span class="o">.</span><span class="n">columnSpacing</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Then subtract the total spacing from the current container, divided by the number of columns.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">useColumnWidth</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">container</span> <span class="n">width</span>
</span></span><span class="line"><span class="cl">  <span class="n">useContainerWidth</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">column</span> <span class="n">width</span>
</span></span><span class="line"><span class="cl">  <span class="n">columnWidth</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">containerWidth</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">columnSpacingTotal</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">/</span> <span class="n">props</span><span class="o">.</span><span class="n">column</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Get the height of each element</strong></p>
<p>Whether the height of the image is defined. If the height is defined, the height of each item can be calculated directly.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">useItemHeight</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Initialize</span> <span class="n">item</span> <span class="n">height</span> <span class="n">list</span>
</span></span><span class="line"><span class="cl">  <span class="n">itemsHeight</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">item</span> <span class="n">element</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">itemElements</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="n">document</span><span class="o">.</span><span class="n">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;hm-waterfall-item&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">item</span> <span class="n">height</span>
</span></span><span class="line"><span class="cl">  <span class="n">itemElements</span><span class="o">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">itemEl</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">itemsHeight</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">itemEl</span><span class="o">.</span><span class="n">offsetHeight</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Render</span> <span class="n">position</span>
</span></span><span class="line"><span class="cl">  <span class="n">useItemLocation</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>If the height is not defined, we need to calculate the height after the image is loaded.</p>
<ul>
<li>
<p>Get item element</p>
</li>
<li>
<p>Get the image path in the itm element</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Get</span> <span class="n">all</span> <span class="n">img</span> <span class="n">elements</span> <span class="ow">in</span> <span class="n">item</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">function</span> <span class="n">getImgElements</span><span class="p">(</span><span class="n">itemElements</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">imgElements</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="n">itemElements</span><span class="o">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">el</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">imgElements</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="o">...</span><span class="n">el</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">imgElements</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Get</span> <span class="n">all</span> <span class="n">image</span> <span class="n">paths</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">function</span> <span class="n">getAllImgSrc</span><span class="p">(</span><span class="n">imgElements</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">allImgSrc</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="n">imgElements</span><span class="o">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">item</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">allImgSrc</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">allImgSrc</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Use the load event of the image object to determine whether the image is loaded, and then calculate the height.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">export</span> <span class="n">function</span> <span class="n">allImgComplete</span><span class="p">(</span><span class="n">allImgSrc</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Store</span> <span class="n">all</span> <span class="n">promise</span> <span class="n">objects</span> <span class="k">for</span> <span class="n">image</span> <span class="n">loading</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">promises</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Loop</span> <span class="n">through</span> <span class="n">allImgSrc</span>
</span></span><span class="line"><span class="cl">  <span class="n">allImgSrc</span><span class="o">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">imgSrc</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">promises</span><span class="o">.</span><span class="n">push</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">new</span> <span class="n">Promise</span><span class="p">((</span><span class="n">resolve</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">const</span> <span class="n">imgObj</span> <span class="o">=</span> <span class="n">new</span> <span class="ne">Image</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">imgObj</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">imgSrc</span>
</span></span><span class="line"><span class="cl">        <span class="n">imgObj</span><span class="o">.</span><span class="n">onload</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">resolve</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="n">imgSrc</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">index</span>
</span></span><span class="line"><span class="cl">          <span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">Promise</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">promises</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">waitImgComplete</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Initialize</span> <span class="n">item</span> <span class="n">height</span> <span class="n">list</span>
</span></span><span class="line"><span class="cl">  <span class="n">itemsHeight</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">item</span> <span class="n">elements</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">itemElements</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="n">document</span><span class="o">.</span><span class="n">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;hm-waterfall-item&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">all</span> <span class="n">img</span> <span class="n">elements</span> <span class="ow">in</span> <span class="n">item</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">imgElements</span> <span class="o">=</span> <span class="n">getImgElements</span><span class="p">(</span><span class="n">itemElements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">all</span> <span class="n">image</span> <span class="n">paths</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">allImgSrc</span> <span class="o">=</span> <span class="n">getAllImgSrc</span><span class="p">(</span><span class="n">imgElements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Preload</span> <span class="n">images</span> <span class="ow">and</span> <span class="n">then</span> <span class="n">calculate</span> <span class="n">height</span>
</span></span><span class="line"><span class="cl">  <span class="n">allImgComplete</span><span class="p">(</span><span class="n">allImgSrc</span><span class="p">)</span><span class="o">.</span><span class="n">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">itemElements</span><span class="o">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">itemEl</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">itemsHeight</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">itemEl</span><span class="o">.</span><span class="n">offsetHeight</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Render</span> <span class="n">location</span>
</span></span><span class="line"><span class="cl">  <span class="n">useItemLocation</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Calculate the offset of each element</strong></p>
<p>They are all calculated based on obtaining the minimum height of the column.</p>
<p>You need to initialize the height of each column to 0, use this object as a container, the key is the column subscript, and the value is the column height.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">//</span> <span class="n">The</span> <span class="n">total</span> <span class="n">height</span> <span class="n">of</span> <span class="n">the</span> <span class="n">container</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">containerHeight</span> <span class="o">=</span> <span class="n">ref</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">Store</span> <span class="n">each</span> <span class="n">column</span><span class="s1">&#39;s height. key: column index, val: column height</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">columnHeightObj</span> <span class="o">=</span> <span class="n">ref</span><span class="p">({})</span>
</span></span><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Create</span> <span class="n">an</span> <span class="n">object</span> <span class="n">to</span> <span class="n">store</span> <span class="n">the</span> <span class="n">height</span> <span class="n">of</span> <span class="n">each</span> <span class="n">column</span><span class="o">.</span> <span class="n">Initialize</span> <span class="n">all</span> <span class="n">as</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">useColumnHeightObj</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">columnHeightObj</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">props</span><span class="o">.</span><span class="n">column</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">columnHeightObj</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>When getting the left offset, we need to get the minimum height column.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">height</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">function</span> <span class="n">getMinHeight</span><span class="p">(</span><span class="n">columnHeightObj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">columnHeightValue</span> <span class="o">=</span> <span class="ne">Object</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">columnHeightObj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">Math</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="o">...</span><span class="n">columnHeightValue</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">column</span> <span class="n">with</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">height</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">function</span> <span class="n">getMinHeightColumn</span><span class="p">(</span><span class="n">columnHeightObj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">height</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">minHeight</span> <span class="o">=</span> <span class="n">getMinHeight</span><span class="p">(</span><span class="n">columnHeightObj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">columns</span> <span class="o">=</span> <span class="ne">Object</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">columnHeightObj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">minHeightColumn</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">find</span><span class="p">((</span><span class="n">col</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">columnHeightObj</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">===</span> <span class="n">minHeight</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">minHeightColumn</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>After getting the minimum height column, just multiply it by the column width and add the spacing.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Calculate</span> <span class="n">the</span> <span class="n">left</span> <span class="n">offset</span> <span class="n">of</span> <span class="n">the</span> <span class="n">current</span> <span class="n">element</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">getItemLeft</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">column</span> <span class="n">with</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">height</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">column</span> <span class="o">=</span> <span class="n">getMinHeightColumn</span><span class="p">(</span><span class="n">columnHeightObj</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Calculate</span> <span class="n">left</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">columnWidth</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">props</span><span class="o">.</span><span class="n">columnSpacing</span><span class="p">)</span> <span class="o">*</span> <span class="n">column</span> <span class="o">+</span> <span class="n">containerLeft</span><span class="o">.</span><span class="n">value</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>To calculate the top offset, we can directly get the minimum height column height.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Calculate</span> <span class="n">the</span> <span class="n">top</span> <span class="n">offset</span> <span class="n">of</span> <span class="n">the</span> <span class="n">current</span> <span class="n">element</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">getItemTop</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">column</span><span class="s1">&#39;s minimum height</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">minHeight</span> <span class="o">=</span> <span class="n">getMinHeight</span><span class="p">(</span><span class="n">columnHeightObj</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">minHeight</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It should be noted that when we complete each element offset assignment, we need to recalculate the height of the minimum height column.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Recalculate</span> <span class="n">the</span> <span class="n">height</span> <span class="n">of</span> <span class="n">the</span> <span class="n">column</span> <span class="n">with</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">height</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">increasingHeight</span> <span class="o">=</span> <span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">column</span> <span class="n">with</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">height</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">column</span> <span class="o">=</span> <span class="n">getMinHeightColumn</span><span class="p">(</span><span class="n">columnHeightObj</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Recalculate</span> <span class="n">the</span> <span class="n">height</span> <span class="k">for</span> <span class="n">this</span> <span class="n">column</span>
</span></span><span class="line"><span class="cl">  <span class="n">columnHeightObj</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> 
</span></span><span class="line"><span class="cl">    <span class="n">columnHeightObj</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">+</span> <span class="n">itemsHeight</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">+</span> <span class="n">props</span><span class="o">.</span><span class="n">rowSpacing</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Finally, assign the maximum height column height to the container height.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">//</span> <span class="n">Render</span> <span class="n">position</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">useItemLocation</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">props</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">item</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">Avoid</span> <span class="n">repeated</span> <span class="n">calculation</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">_style</span><span class="p">)</span> <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">Obtain</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">height</span> <span class="ow">and</span> <span class="n">calculate</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span> <span class="ow">in</span> <span class="n">_style</span>
</span></span><span class="line"><span class="cl">    <span class="n">item</span><span class="o">.</span><span class="n">_style</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="n">item</span><span class="o">.</span><span class="n">_style</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">getItemLeft</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">item</span><span class="o">.</span><span class="n">_style</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">getItemTop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">Every</span> <span class="n">time</span> <span class="n">the</span> <span class="n">offset</span> <span class="n">is</span> <span class="n">set</span><span class="p">,</span> <span class="n">the</span> <span class="n">height</span> <span class="n">of</span> <span class="n">the</span> <span class="n">shortest</span> <span class="n">column</span> <span class="n">needs</span> <span class="n">to</span> <span class="n">be</span> <span class="n">updated</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">    <span class="n">increasingHeight</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Once</span> <span class="n">all</span> <span class="n">items</span> <span class="n">have</span> <span class="n">their</span> <span class="n">offsets</span> <span class="n">set</span><span class="p">,</span> <span class="n">set</span> <span class="n">the</span> <span class="n">container</span> <span class="n">height</span> <span class="n">to</span> <span class="n">the</span> <span class="n">height</span> <span class="n">of</span> <span class="n">the</span> <span class="n">tallest</span> <span class="n">column</span>
</span></span><span class="line"><span class="cl">  <span class="n">containerHeight</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">getMaxHeight</span><span class="p">(</span><span class="n">columnHeightObj</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/javascript/">Javascript</a>
        
            <a href="/tags/vue/">Vue</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/understanding-definemodel-in-vue3/">
        
        
            <div class="article-image">
                
                    <img src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*XNUMO2PM_SwVgmdGARQtCQ.png" loading="lazy" data-key="" data-hash="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*XNUMO2PM_SwVgmdGARQtCQ.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Understanding defineModel in Vue3</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/understanding-fragment-in-vue3/">
        
        
            <div class="article-image">
                
                    <img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YMMs8s-H6fct1k8DJ1vLRw.png" loading="lazy" data-key="" data-hash="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YMMs8s-H6fct1k8DJ1vLRw.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Understanding Fragment in Vue3</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/understanding-teleport-in-vue3/">
        
        
            <div class="article-image">
                
                    <img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GgMh0JyvKDIrI7ahnm8uiQ.jpeg" loading="lazy" data-key="" data-hash="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GgMh0JyvKDIrI7ahnm8uiQ.jpeg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Understanding Teleport in Vue3</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/understanding-async-components-in-vue3/">
        
        
            <div class="article-image">
                
                    <img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SoXuFiQrG7Mex4MN6hmO3g.jpeg" loading="lazy" data-key="" data-hash="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SoXuFiQrG7Mex4MN6hmO3g.jpeg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Understanding Async Components in Vue3</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/understanding-watch-and-watcheffect-in-vue3/">
        
        
            <div class="article-image">
                
                    <img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v6hSD9YqWXc8J6oR-4kQsQ.png" loading="lazy" data-key="" data-hash="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v6hSD9YqWXc8J6oR-4kQsQ.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Understanding watch and watchEffect in Vue3</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="kxming/skstory"
    data-repo-id="R_kgDOLehX4A"
    data-category="Announcements"
    data-category-id="DIC_kwDOLehX4M4Cd4Vx"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark_dimmed');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2024 SK Story
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.24.1">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
