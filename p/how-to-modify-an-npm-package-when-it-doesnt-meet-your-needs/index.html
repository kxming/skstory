<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="During the development process, if you find that the functionality of an NPM package does not fully meet the requirements, or there are bugs, how to deal with it?\nThere are scenarios where you might find a bug in an NPM package during development. Here&rsquo;s how you can handle such situations:\nSubmit an Issue or Pull Request: The first step is to submit an issue to the original author or fork the repository, make the necessary changes, and create a pull request. However, this approach has a significant downside\u200a-\u200ait can be time-consuming. If the author is strict or inactive, it might take a long time for your changes to be merged, which your project might not be able to afford.\n"><title>How to Modify an NPM Package When It Doesn't Meet Your¬†Needs</title>
<link rel=canonical href=https://www.skstory.online/p/how-to-modify-an-npm-package-when-it-doesnt-meet-your-needs/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="How to Modify an NPM Package When It Doesn't Meet Your\u00a0Needs"><meta property='og:description' content="During the development process, if you find that the functionality of an NPM package does not fully meet the requirements, or there are bugs, how to deal with it?\nThere are scenarios where you might find a bug in an NPM package during development. Here&rsquo;s how you can handle such situations:\nSubmit an Issue or Pull Request: The first step is to submit an issue to the original author or fork the repository, make the necessary changes, and create a pull request. However, this approach has a significant downside\u200a-\u200ait can be time-consuming. If the author is strict or inactive, it might take a long time for your changes to be merged, which your project might not be able to afford.\n"><meta property='og:url' content='https://www.skstory.online/p/how-to-modify-an-npm-package-when-it-doesnt-meet-your-needs/'><meta property='og:site_name' content='SK Story'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Story'><meta property='article:tag' content='Fiction'><meta property='article:tag' content='Life'><meta property='article:published_time' content='2024-07-30T16:02:05+08:00'><meta property='article:modified_time' content='2024-07-30T16:02:05+08:00'><meta property='og:image' content='https://cdn-images-1.medium.com/max/1600/1*ZS3iplWNdqvLSRzbbh8MzA.png'><meta name=twitter:site content="@https://twitter.com/ShawnKxming"><meta name=twitter:creator content="@https://twitter.com/ShawnKxming"><meta name=twitter:title content="How to Modify an NPM Package When It Doesn't Meet Your\u00a0Needs"><meta name=twitter:description content="During the development process, if you find that the functionality of an NPM package does not fully meet the requirements, or there are bugs, how to deal with it?\nThere are scenarios where you might find a bug in an NPM package during development. Here&rsquo;s how you can handle such situations:\nSubmit an Issue or Pull Request: The first step is to submit an issue to the original author or fork the repository, make the necessary changes, and create a pull request. However, this approach has a significant downside\u200a-\u200ait can be time-consuming. If the author is strict or inactive, it might take a long time for your changes to be merged, which your project might not be able to afford.\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://cdn-images-1.medium.com/max/1600/1*ZS3iplWNdqvLSRzbbh8MzA.png'><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu1157332405703967761.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üç•</span></figure><div class=site-meta><h1 class=site-name><a href=/>SK Story</a></h1><h2 class=site-description>Shawn King's Stories Website</h2></div></header><ol class=menu-social><li><a href=mailto:kxming0229@gmail.com target=_blank title=Email rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z"/><path d="M3 7l9 6 9-6"/></svg></a></li><li><a href=https://www.facebook.com/p/King-Shawn-100092679065959/ target=_blank title=Facebook rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-facebook"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 10v4h3v7h4v-7h3l1-4h-4V8a1 1 0 011-1h3V3h-3a5 5 0 00-5 5v2H7"/></svg></a></li><li><a href=https://twitter.com/ShawnKxming target=_blank title=Twitter rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-x"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16H20L8.267 4z"/><path d="M4 20l6.768-6.768m2.46-2.46L20 4"/></svg></a></li><li><a href=https://t.me/shawnkxming target=_blank title=Telegram rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-telegram"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 10l-4 4 6 6 4-16-18 7 4 2 2 6 3-4"/></svg></a></li><li><a href=https://medium.com/@kxming target=_blank title=Medium rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-medium"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 9h1l3 3 3-3h1"/><path d="M8 15h2"/><path d="M14 15h2"/><path d="M9 9v6"/><path d="M15 9v6"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#using-fork>Using Fork</a></li><li><a href=#submitting-pr>Submitting PR</a></li><li><a href=#external-code-modification>External Code Modification</a></li><li><a href=#pnpm-patch>pnpm patch</a></li><li><a href=#aliases>Aliases</a></li><li><a href=#patch-package>patch-package</a></li><li><a href=#advantages-of-patch-package>Advantages of patch-package</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/how-to-modify-an-npm-package-when-it-doesnt-meet-your-needs/><img src=https://cdn-images-1.medium.com/max/1600/1*ZS3iplWNdqvLSRzbbh8MzA.png loading=lazy alt="Featured image of post How to Modify an NPM Package When It Doesn't Meet Your¬†Needs"></a></div><div class=article-details><header class=article-category><a href=/categories/story/>Story
</a><a href=/categories/fiction/ style=background-color:#2a849d;color:#fff>Fiction
</a><a href=/categories/life/>Life</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/how-to-modify-an-npm-package-when-it-doesnt-meet-your-needs/>How to Modify an NPM Package When It Doesn't Meet Your¬†Needs</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 30, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>6 minute read</time></div></footer></div></header><section class=article-content><p>During the development process, if you find that the functionality of an NPM package does not fully meet the requirements, or there are bugs, how to deal with it?</p><p>There are scenarios where you might find a bug in an NPM package during development. Here&rsquo;s how you can handle such situations:</p><ol><li><p>Submit an Issue or Pull Request: The first step is to submit an issue to the original author or fork the repository, make the necessary changes, and create a pull request. However, this approach has a significant downside‚Ää-‚Ääit can be time-consuming. If the author is strict or inactive, it might take a long time for your changes to be merged, which your project might not be able to afford.</p></li><li><p>Temporary or Alternative Solutions: In cases where modifying the source package is not feasible, you need a temporary or alternative solution. Here are two common scenarios:</p></li></ol><ul><li><p><strong>Small Code Changes</strong>: If the required modifications are minimal, consider using a patch.</p></li><li><p><strong>Large Code Changes or Obfuscated Code</strong>: If the changes are extensive or the package code is minified/obfuscated, making direct modifications might not be practical. In this case, you can modify the source code, change the package name, and republish it. Then, update your project to use this new package.</p></li></ul><p>Directly modifying the code in node_modules is possible but not recommended, as these changes will be lost the next time you run npm install or update the package. Below are some recommended methods to handle this situation effectively:</p><h2 id=using-fork>Using Fork</h2><p>The most common method is to fork the source code. You can fork the repository of the third-party package on GitHub or other hosting platforms. After making modifications to the source code, publish the modified package to npm. If you do not want it to be public, you can set up a private npm package. Switch the package in your project to the one you published.</p><h2 id=submitting-pr>Submitting PR</h2><p>If you believe your modification could benefit other users, you can submit a pull request (PR) to the original package&rsquo;s maintainer. If the PR is accepted and merged, you can directly use the future versions of the official package without maintaining a fork.</p><h2 id=external-code-modification>External Code Modification</h2><p>This method involves not directly modifying the source code in <code>node_modules</code>, but using JavaScript features to modify the internal properties of the package during execution.</p><p>In simple terms, it involves using <code>defineProperty</code>, <code>prototype</code>, and other features to modify classes within the package. For example, in Vue 2.0, <code>defineProperty</code> is used to intercept and proxy data on component instances. In Vue projects, we often mount global properties and methods on the Vue root instance <code>Vue.prototype.xxx = xxxx</code> in <code>main.js</code>.</p><h2 id=pnpm-patch>pnpm patch</h2><p><code>pnpm</code>&rsquo;s patch command is inspired by a similar command in yarn.</p><p>First, execute <code>pnpm patch &lt;pkg name>@&lt;version></code>. This command extracts the specified package to a temporary directory where you can freely edit it.
After making modifications, run <code>pnpm patch-commit &lt;path> </code>(the path is the temporary directory created earlier, which can be long and hard to remember, but don&rsquo;t worry, the CLI will provide complete prompts) to generate a patch file and register it in your project using the <code>patchedDependencies</code> field.</p><h2 id=aliases>Aliases</h2><p>pnpm provides an aliasing capability.</p><p>Suppose you published a new package called awesome-lodash and use lodash as an alias to install it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pnpm add lodash@npm:awesome-lodash
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s assume you use lodash all over your project. There is a bug in lodash that breaks your project. You have a fix but lodash won&rsquo;t merge it. Normally you would either install lodash from your fork directly (as a git-hosted dependency) or publish it with a different name. If you use the second solution you have to replace all the requires in your project with the new dependency name (<code>require('lodash') => require('awesome-lodash')</code>). With aliases, you have a third option.</p><p>Publish a new package called <code>awesome-lodash</code> and install it using lodash as its alias:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pnpm add lodash@npm:awesome-lodash
</span></span></code></pre></td></tr></table></div></div><p>No changes in code are needed. All the requires of lodash will now resolve to awesome-lodash.</p><p>Sometimes you&rsquo;ll want to use two different versions of a package in your project. Easy:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pnpm add lodash1@npm:lodash@1
</span></span><span class=line><span class=cl>pnpm add lodash2@npm:lodash@2
</span></span></code></pre></td></tr></table></div></div><p>Now you can require the first version of lodash via require(&rsquo;lodash1&rsquo;) and the second via require(&rsquo;lodash2&rsquo;).</p><p>This gets even more powerful when combined with hooks. Maybe you want to replace lodash with awesome-lodash in all the packages in node_modules. You can easily achieve that with the following <code>.pnpmfile.cjs</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>function</span> <span class=n>readPackage</span><span class=p>(</span><span class=n>pkg</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>dependencies</span> <span class=o>&amp;&amp;</span> <span class=n>pkg</span><span class=o>.</span><span class=n>dependencies</span><span class=o>.</span><span class=n>lodash</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>pkg</span><span class=o>.</span><span class=n>dependencies</span><span class=o>.</span><span class=n>lodash</span> <span class=o>=</span> <span class=s1>&#39;npm:awesome-lodash@^1.0.0&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>pkg</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>module</span><span class=o>.</span><span class=n>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>hooks</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>readPackage</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=patch-package>patch-package</h2><p><a class=link href=https://www.npmjs.com/package/patch-package#why-use-postinstall-postinstall-with-yarn target=_blank rel=noopener>patch-package</a>is a tool for fixing third-party dependencies, and it is very easy to use.</p><p><strong>Installation</strong>Ôºö</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>$</span> <span class=nx>npm</span> <span class=nx>i</span> <span class=nx>patch</span><span class=o>-</span><span class=kn>package</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>or</span> <span class=nx>with</span> <span class=nx>yarn</span>
</span></span><span class=line><span class=cl><span class=err>$</span> <span class=nx>yarn</span> <span class=nx>add</span> <span class=nx>patch</span><span class=o>-</span><span class=kn>package</span> <span class=nx>postinstall</span><span class=o>-</span><span class=nx>postinstall</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>Note</strong>: Most times when you do a yarn, yarn add, yarn remove, or yarn install (which is the same as just yarn) Yarn will completely replace the contents of your node_modules with freshly unpackaged modules. patch-package uses the postinstall hook to modify these fresh modules, so that they behave well according to your will.</p><p>Yarn only runs the postinstall hook after yarn and yarn add, but not after yarn remove. The postinstall-postinstall package is used to make sure your postinstall hook gets executed even after a yarn remove.</p></blockquote><p><strong>Usage:</strong></p><p>First make changes to the files of a particular package in your node_modules folder, then run</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>npx</span> <span class=nx>patch</span><span class=o>-</span><span class=kn>package</span> <span class=kn>package</span><span class=o>-</span><span class=nx>name</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>or</span> <span class=nx>with</span> <span class=nx>yarn</span>
</span></span><span class=line><span class=cl><span class=nx>yarn</span> <span class=nx>patch</span><span class=o>-</span><span class=kn>package</span> <span class=kn>package</span><span class=o>-</span><span class=nx>name</span>
</span></span></code></pre></td></tr></table></div></div><p>This will create a <code>patches</code> file in the root directory of your project that contains all the changes made to the files of the specified package in node_modules. Inside will be a file called package-name+0.44.0.patch or something, which is a diff between normal old package-name and your fixed version. You can then commit this <code>patches</code> file along with your other changes. When you install dependencies again, patch-package will apply these patches automatically.</p><p>After completing the above steps, add the following to the <code>scripts</code> section in <code>package.json</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;scripts&#34;: {
</span></span><span class=line><span class=cl>  &#34;postinstall&#34;: &#34;patch-package&#34;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>This way, when other team members pull the code and run <code>npm install</code> or <code>yarn install</code>, the patches will be automatically applied to the dependencies.</p><p>In simple terms, this solution records the code and location of the patch and uses npm&rsquo;s hook (the <code>postinstall</code> hook is triggered after <code>npm install</code>) to trigger the corresponding script after installing dependencies, overwriting the patches to the corresponding package in <code>node_modules</code>.</p><p>Of course, patches are version-specific, so you need to lock the version number. The downside is that if you need to upgrade, you have to repeat the process, but unless there are bugs or performance issues, you usually do not need to chase new versions.</p><h2 id=advantages-of-patch-package>Advantages of patch-package</h2><p>Although the above methods can solve specific scenarios through some tricks, they cannot avoid the problems caused by version upgrades. If the npm package is upgraded, it may cause errors in the previous modifications. Therefore, if you want to use the above methods, it is best to lock the version number. However, patch-package has the following features:</p><ul><li><p><strong>Version Mismatch</strong></p><p>If the version of the package you installed does not match the version recorded in your previous patch, npx patch-package will directly report an ERROR: Failed to apply patch for package xxxx at path. The prompt helps you locate the problem more easily.</p></li><li><p><strong>Space Saving</strong></p><p>Using git diff to record patches is more space-saving than rewriting a source code, making it both safe and convenient.</p></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/story/>Story</a>
<a href=/tags/fiction/>Fiction</a>
<a href=/tags/life/>Life</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/recording-my-current-mac-applications/><div class=article-image><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Ie5puTXFNbSKEZ61ibY6A.jpeg loading=lazy data-key data-hash=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Ie5puTXFNbSKEZ61ibY6A.jpeg></div><div class=article-details><h2 class=article-title>Recording My Current Mac Applications</h2></div></a></article><article class=has-image><a href=/p/jumping-out-of-nested-loops-in-javascript/><div class=article-image><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Ie5puTXFNbSKEZ61ibY6A.jpeg loading=lazy data-key data-hash=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Ie5puTXFNbSKEZ61ibY6A.jpeg></div><div class=article-details><h2 class=article-title>Jumping Out of Nested Loops in JavaScript</h2></div></a></article><article class=has-image><a href=/p/exploring-the-difference-between-width-100-and-width-auto/><div class=article-image><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6aTlWcQeK-86tPxH.png loading=lazy data-key data-hash=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6aTlWcQeK-86tPxH.png></div><div class=article-details><h2 class=article-title>Exploring the Difference Between width: 100% and width: auto</h2></div></a></article><article class=has-image><a href=/p/understanding-useid-in-vue3/><div class=article-image><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6aTlWcQeK-86tPxH.png loading=lazy data-key data-hash=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6aTlWcQeK-86tPxH.png></div><div class=article-details><h2 class=article-title>Understanding useId in Vue3</h2></div></a></article><article class=has-image><a href=/p/12-vue-3-backend-management-templates-to-bookmark-and-learn/><div class=article-image><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u483g0dL7NmbtDvGH817bg.png loading=lazy data-key data-hash=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u483g0dL7NmbtDvGH817bg.png></div><div class=article-details><h2 class=article-title>12 Vue 3 Backend Management Templates to Bookmark and Learn</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=kxming/skstory data-repo-id=R_kgDOLehX4A data-category=Announcements data-category-id=DIC_kwDOLehX4M4Cd4Vx data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en-us data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2024 SK Story</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.29.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>