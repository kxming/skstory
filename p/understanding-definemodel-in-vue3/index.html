<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="It can simplify the two-way binding between parent and child components and is the currently officially recommended two-way binding implementation."><title>Understanding defineModel in Vue3</title>
<link rel=canonical href=https://www.skstory.online/p/understanding-definemodel-in-vue3/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Understanding defineModel in Vue3"><meta property='og:description' content="It can simplify the two-way binding between parent and child components and is the currently officially recommended two-way binding implementation."><meta property='og:url' content='https://www.skstory.online/p/understanding-definemodel-in-vue3/'><meta property='og:site_name' content='SK Story'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Javascript'><meta property='article:tag' content='Vue'><meta property='article:published_time' content='2024-03-08T16:22:38+08:00'><meta property='article:modified_time' content='2024-03-08T16:22:38+08:00'><meta property='og:image' content='https://miro.medium.com/v2/resize:fit:1274/format:webp/1*XNUMO2PM_SwVgmdGARQtCQ.png'><meta name=twitter:site content="@https://twitter.com/ShawnKxming"><meta name=twitter:creator content="@https://twitter.com/ShawnKxming"><meta name=twitter:title content="Understanding defineModel in Vue3"><meta name=twitter:description content="It can simplify the two-way binding between parent and child components and is the currently officially recommended two-way binding implementation."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://miro.medium.com/v2/resize:fit:1274/format:webp/1*XNUMO2PM_SwVgmdGARQtCQ.png'><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu1157332405703967761.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üç•</span></figure><div class=site-meta><h1 class=site-name><a href=/>SK Story</a></h1><h2 class=site-description>Shawn King's Stories Website</h2></div></header><ol class=menu-social><li><a href=mailto:kxming0229@gmail.com target=_blank title=Email rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z"/><path d="M3 7l9 6 9-6"/></svg></a></li><li><a href=https://www.facebook.com/p/King-Shawn-100092679065959/ target=_blank title=Facebook rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-facebook"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 10v4h3v7h4v-7h3l1-4h-4V8a1 1 0 011-1h3V3h-3a5 5 0 00-5 5v2H7"/></svg></a></li><li><a href=https://twitter.com/ShawnKxming target=_blank title=Twitter rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-x"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16H20L8.267 4z"/><path d="M4 20l6.768-6.768m2.46-2.46L20 4"/></svg></a></li><li><a href=https://t.me/shawnkxming target=_blank title=Telegram rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-telegram"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 10l-4 4 6 6 4-16-18 7 4 2 2 6 3-4"/></svg></a></li><li><a href=https://medium.com/@kxming target=_blank title=Medium rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-medium"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 9h1l3 3 3-3h1"/><path d="M8 15h2"/><path d="M14 15h2"/><path d="M9 9v6"/><path d="M15 9v6"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#how-to-implement-two-way-binding-in-the-past>How to implement two-way binding in the past</a></li><li><a href=#use-definemodel-to-implement-two-way-data-binding>Use defineModel to implement two-way data binding</a></li><li><a href=#implementation-principle>Implementation principle</a></li><li><a href=#how-to-define-type-default-etc-in-definemodel>How to define type, default, etc. in defineModel?</a></li><li><a href=#how-to-implement-multiple-v-model-bindings-in-definemodel>How to implement multiple v-model bindings in defineModel?</a></li><li><a href=#how-to-use-built-in-and-custom-modifiers-in-definemodel>How to use built-in and custom modifiers in defineModel?</a></li><li><a href=#summary>Summary</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/understanding-definemodel-in-vue3/><img src=https://miro.medium.com/v2/resize:fit:1274/format:webp/1*XNUMO2PM_SwVgmdGARQtCQ.png loading=lazy alt="Featured image of post Understanding defineModel in Vue3"></a></div><div class=article-details><header class=article-category><a href=/categories/javascript/ style=background-color:#d1d419;color:#fff>Javascript
</a><a href=/categories/vue/ style=background-color:#28a243;color:#fff>Vue</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/understanding-definemodel-in-vue3/>Understanding defineModel in Vue3</a></h2><h3 class=article-subtitle>It can simplify the two-way binding between parent and child components and is the currently officially recommended two-way binding implementation.</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 08, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>7 minute read</time></div></footer></div></header><section class=article-content><p>With the release of <code>vue3.4</code> version, <code>defineModel</code> has also officially become a regular version. It can simplify the two-way binding between parent and child components and is the currently officially recommended two-way binding implementation.</p><hr><h2 id=how-to-implement-two-way-binding-in-the-past>How to implement two-way binding in the past</h2><p>Everyone should know that <code>v-model</code> is just syntactic sugar. It actually defines the <code>modelValue</code> attribute and listens for the <code>update:modelValue</code> event for the component, so we had to implement two-way data binding before. You need to define a <code>modelValue</code> attribute for the subcomponent, and when you want to update the modelValue value in the subcomponent, you need to <code>emit</code> send out a <code>update:modelValue</code> event. Pass the new value as the second field.</p><p>Let‚Äôs look at a simple example. The code of the parent component is as follows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&lt;</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=n>CommonInput</span> <span class=n>v</span><span class=o>-</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;inputValue&#34;</span> <span class=o>/&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>script</span> <span class=n>setup</span> <span class=n>lang</span><span class=o>=</span><span class=s2>&#34;ts&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=p>{</span> <span class=n>ref</span> <span class=p>}</span> <span class=n>from</span> <span class=s2>&#34;vue&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>inputValue</span> <span class=o>=</span> <span class=n>ref</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>script</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>The code for the subcomponent is as follows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&lt;</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=n>input</span>
</span></span><span class=line><span class=cl>    <span class=p>:</span><span class=n>value</span><span class=o>=</span><span class=s2>&#34;props.modelValue&#34;</span>
</span></span><span class=line><span class=cl>    <span class=err>@</span><span class=n>input</span><span class=o>=</span><span class=s2>&#34;emit(&#39;update:modelValue&#39;, $event.target.value)&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>/&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>script</span> <span class=n>setup</span> <span class=n>lang</span><span class=o>=</span><span class=s2>&#34;ts&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>props</span> <span class=o>=</span> <span class=n>defineProps</span><span class=p>([</span><span class=s2>&#34;modelValue&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>emit</span> <span class=o>=</span> <span class=n>defineEmits</span><span class=p>([</span><span class=s2>&#34;update:modelValue&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>script</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>The above example should be very familiar to everyone. It‚Äôs how we used to implement two-way binding with <code>v-model</code>. But there is a problem, the input box actually supports direct use of <code>v-model</code>, but we did not use <code>v-model</code> here, instead we <code>added</code> value attribute and <code>input</code> event to the input box.</p><p>The reason is that starting from Vue2, it has been a one-way data flow, and the value in the <code>props</code> cannot be directly modified in the child components. Instead, an event should be thrown from the child component, and the parent component should listen to this event, and then modify the variable passed to the <code>props</code> in the parent component. If we directly add <code>v-model = 'props.modelValue‚Äô</code> to the input box here, it is actually modifying the <code>modelValue</code> directly in the <code>props</code> of the child component. Due to the reason of one-way data flow, Vue does not support the direct modification of <code>props</code>, so we need to write the code in the above way.</p><h2 id=use-definemodel-to-implement-two-way-data-binding>Use defineModel to implement two-way data binding</h2><p>The code of the parent component is the same as before, as follows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&lt;</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=n>CommonInput</span> <span class=n>v</span><span class=o>-</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;inputValue&#34;</span> <span class=o>/&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>script</span> <span class=n>setup</span> <span class=n>lang</span><span class=o>=</span><span class=s2>&#34;ts&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=p>{</span> <span class=n>ref</span> <span class=p>}</span> <span class=n>from</span> <span class=s2>&#34;vue&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>inputValue</span> <span class=o>=</span> <span class=n>ref</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>script</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>The code for the subcomponent is as follows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&lt;</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=n>input</span> <span class=n>v</span><span class=o>-</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;model&#34;</span> <span class=o>/&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>script</span> <span class=n>setup</span> <span class=n>lang</span><span class=o>=</span><span class=s2>&#34;ts&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>model</span> <span class=o>=</span> <span class=n>defineModel</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=s2>&#34;xxx&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>script</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>In the above example, we directly bind the return value of <code>defineModel</code> to the input box using <code>v-model</code> , without defining the <code>modelValue</code> attribute and monitoring <code>update:modelValue</code> is a <code>ref</code> . We can modify the value of the <code>model</code> variable in the child component, and the <code>inputValue</code> in the parent component The value of the variable is also updated synchronously, so that two-way binding can be achieved.</p><p>Now here comes the question, from Vue2 onward, we‚Äôve been operating with one-way data flow. When the value of the child component is modified, the variable value of the parent component is also changed. Does this not revert back to the two-way data flow of Vue1? Actually it‚Äôs not the case, it is still a one-way data flow.</p><p>We will briefly explain the implementation principle of <code>defineModel</code> in the following.</p><h2 id=implementation-principle>Implementation principle</h2><p><code>defineModel</code> actually defines a variable called <code>model</code> within the child component as ref and <code>modelValue</code> as props, and it also watches the <code>modelValue</code> in the props. When the value of <code>modelValue</code> in props changes, it will synchronize and update the value of the model variable.</p><p>Moreover, when the value of the <code>model</code> variable inside the child component changes, it will <code>emit</code> an <code>update:modelValue</code> event. Once the parent component receives this event, it will update the corresponding variable value within the parent component.</p><p>The implementation principle code is as follows.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&lt;</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=n>input</span> <span class=n>v</span><span class=o>-</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;model&#34;</span> <span class=o>/&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>script</span> <span class=n>setup</span> <span class=n>lang</span><span class=o>=</span><span class=s2>&#34;ts&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=p>{</span> <span class=n>ref</span><span class=p>,</span> <span class=n>watch</span> <span class=p>}</span> <span class=n>from</span> <span class=s2>&#34;vue&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>props</span> <span class=o>=</span> <span class=n>defineProps</span><span class=p>([</span><span class=s2>&#34;modelValue&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>emit</span> <span class=o>=</span> <span class=n>defineEmits</span><span class=p>([</span><span class=s2>&#34;update:modelValue&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>model</span> <span class=o>=</span> <span class=n>ref</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>watch</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>()</span> <span class=o>=&gt;</span> <span class=n>props</span><span class=o>.</span><span class=n>modelValue</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>props</span><span class=o>.</span><span class=n>modelValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>watch</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>emit</span><span class=p>(</span><span class=s2>&#34;update:modelValue&#34;</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>script</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>After reading the above code, you should understand why the return value of <code>defineModel</code> can be directly modified in the child component, and the corresponding variables of the parent component will also be updated synchronously. What we modify is actually the ref variable returned by <code>defineModel</code> , rather than directly modifying modelValue in props. The implementation method is still the same as vue3.4 &rsquo;s previous two-way binding, except that <code>defineModel</code> macro helps us encapsulate the previous cumbersome code into internal implementation.</p><p>In fact, the source code of <code>defineModel</code> is implemented using <code>customRef</code> and <code>watchSyncEffect</code>. I used the examples of ref and watch here, in order to make it easier for everyone to understand the implementation principle of <code>defineModel</code>.</p><h2 id=how-to-define-type-default-etc-in-definemodel>How to define type, default, etc. in defineModel?</h2><p>Since <code>defineModel</code> declares a <code>prop</code>, it can also define the <code>type</code> and default of <code>prop</code>. The specific code is as follows.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=k>const</span> <span class=n>model</span> <span class=o>=</span> <span class=n>defineModel</span><span class=p>({</span> <span class=n>type</span><span class=p>:</span> <span class=ne>String</span><span class=p>,</span> <span class=n>default</span><span class=p>:</span> <span class=s2>&#34;20&#34;</span> <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>In addition to supporting <code>type</code> and <code>default</code> , required and validator are also supported. The usage is the same as when defining <code>prop</code> .</p><h2 id=how-to-implement-multiple-v-model-bindings-in-definemodel>How to implement multiple v-model bindings in defineModel?</h2><p>It also supports multiple <code>v-model</code> bindings on the parent component. At this time, the first parameter we pass to <code>defineModel</code> is not an object, but a string.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=k>const</span> <span class=n>model1</span> <span class=o>=</span> <span class=n>defineModel</span><span class=p>(</span><span class=s2>&#34;count1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>model2</span> <span class=o>=</span> <span class=n>defineModel</span><span class=p>(</span><span class=s2>&#34;count2&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>The code when using v-model in the parent component is as follows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;CommonInput v-model:count1=&#34;inputValue1&#34; /&gt;
</span></span><span class=line><span class=cl>&lt;CommonInput v-model:count2=&#34;inputValue2&#34; /&gt;
</span></span></code></pre></td></tr></table></div></div><p>We can also define <code>type</code> , <code>default</code> , etc. in multiple <code>v-model</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=k>const</span> <span class=n>model1</span> <span class=o>=</span> <span class=n>defineModel</span><span class=p>(</span><span class=s2>&#34;count1&#34;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>type</span><span class=p>:</span> <span class=ne>String</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>default</span><span class=p>:</span> <span class=s2>&#34;aaa&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=how-to-use-built-in-and-custom-modifiers-in-definemodel>How to use built-in and custom modifiers in defineModel?</h2><p>If you want to use the system‚Äôs built-in modifiers such as <code>trim</code> , the writing method of the parent component is still the same as before:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;CommonInput v-model.trim=&#34;inputValue&#34; /&gt;
</span></span></code></pre></td></tr></table></div></div><p>There is no need to make any modifications to the subcomponent, it is the same as the other <code>defineModel</code> examples above:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=k>const</span> <span class=n>model</span> <span class=o>=</span> <span class=n>defineModel</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p><code>defineModel</code> also supports custom modifiers. For example, if we want to implement a uppercase custom modifier that changes all letters in the input box to uppercase, we also need to use the built-in trim modifier.</p><p>The parent component code is as follows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;CommonInput v-model.trim.uppercase=&#34;inputValue&#34; /&gt;
</span></span></code></pre></td></tr></table></div></div><p>The subcomponent needs to be written like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>&lt;</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=n>input</span> <span class=n>v</span><span class=o>-</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;modelValue&#34;</span> <span class=o>/&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>template</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>script</span> <span class=n>setup</span> <span class=n>lang</span><span class=o>=</span><span class=s2>&#34;ts&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=p>[</span><span class=n>modelValue</span><span class=p>,</span> <span class=n>modelModifiers</span><span class=p>]</span> <span class=o>=</span> <span class=n>defineModel</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=n>set</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>modelModifiers</span><span class=o>.</span><span class=n>uppercase</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>value</span><span class=err>?</span><span class=o>.</span><span class=n>toUpperCase</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>script</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>At this time, the first argument we pass to <code>defineModel</code> is an object containing <code>get</code> and <code>set</code> methods. When reading the <code>modelValue</code> variable, it will go into the <code>get</code> method. When writing to the <code>modelValue</code> variable, it will go into the <code>set</code> method. If only interception of write operations is needed, then <code>get</code> can be omitted.</p><p>The return value of <code>defineModel</code> can also be destructured into two variables. The first variable is the <code>ref</code> object we used for <code>v-model</code> binding in the previous examples. The second variable is an object, which contains what modifiers are there. Here we have two modifiers <code>trim</code> and uppercase, so the <code>value</code> of modelModifiers is:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  trim: true,
</span></span><span class=line><span class=cl>  uppercase: true
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>When input is made in an input box, it will go to the <code>set</code> method, and then calling <code>value?.toUpperCase()</code> can convert the entered letters into uppercase.</p><h2 id=summary>Summary</h2><p>This article introduces how to use the <code>defineModel</code> macro to implement two-way binding and the implementation principle of <code>defineModel</code>.</p><ul><li><p>Calling the defineModel macro within a child component will return a ref object. Inside the child component, this ref object can be directly assigned, and the corresponding variable in the parent component will be modified synchronously.</p></li><li><p>Essentially, defineModel defines a ref variable and a corresponding prop within the child component, and then listens to the corresponding prop to keep the value of the ref variable consistent with the corresponding prop. When the value of the ref variable is modified in the child component, an event is thrown to the parent component to update the corresponding variable value, thereby achieving two-way binding.</p></li><li><p>By using defineModel({ type: String, default: ‚Äò20‚Äô }) you can define options such as type and default for the prop.</p></li><li><p>Using defineModel(‚Äòcount‚Äô) can implement multiple v-model bindings.</p></li><li><p>By destructuring the return value of defineModel(), the modelModifiers modifier object can be obtained. Custom modifiers can be implemented in combination with the ‚Äúget‚Äù and set converter options.</p></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/javascript/>Javascript</a>
<a href=/tags/vue/>Vue</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/understanding-keepalive-in-vue3/><div class=article-image><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SNKB1Duz47DDtnG1.png loading=lazy data-key data-hash=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SNKB1Duz47DDtnG1.png></div><div class=article-details><h2 class=article-title>Understanding KeepAlive in Vue3</h2></div></a></article><article class=has-image><a href=/p/understanding-v-memo-in-vue3/><div class=article-image><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mHgmXlGtuB6aLKdr.jpg loading=lazy data-key data-hash=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mHgmXlGtuB6aLKdr.jpg></div><div class=article-details><h2 class=article-title>Understanding v-memo in Vue3</h2></div></a></article><article class=has-image><a href=/p/understanding-suspense-in-vue3/><div class=article-image><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J3V7D8PQIiGwlztx.jpeg loading=lazy data-key data-hash=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J3V7D8PQIiGwlztx.jpeg></div><div class=article-details><h2 class=article-title>Understanding Suspense in Vue3</h2></div></a></article><article class=has-image><a href=/p/understanding-reactive-isreactive-and-shallowreactive-in-vue3/><div class=article-image><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Lf_gf2uitG3fuTvg.jpg loading=lazy data-key data-hash=https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Lf_gf2uitG3fuTvg.jpg></div><div class=article-details><h2 class=article-title>Understanding reactive, isReactive and shallowReactive in Vue3</h2></div></a></article><article class=has-image><a href=/p/vue3-api-overview/><div class=article-image><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jiE6x4r2qIl3C2PBHdDsug.png loading=lazy data-key data-hash=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jiE6x4r2qIl3C2PBHdDsug.png></div><div class=article-details><h2 class=article-title>vue3 API¬†Overview</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=kxming/skstory data-repo-id=R_kgDOLehX4A data-category=Announcements data-category-id=DIC_kwDOLehX4M4Cd4Vx data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en-us data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2024 SK Story</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.29.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>